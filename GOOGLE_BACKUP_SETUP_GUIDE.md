# ๐ ุฏููู ุฅุนุฏุงุฏ ุงููุณุฎ ุงูุงุญุชูุงุทู Google Sheets & Forms
**ูุธุงู ุงูุญุถูุฑ ุงูููุณููู - ุฌุงูุนุฉ ุงูุฒูุงุฒูู**

---

## ๐ฏ **ูุธุฑุฉ ุนุงูุฉ**

ูุฐุง ุงููุธุงู ูููุฑ ุญูุงู ุงุญุชูุงุทูุงู ุชููุงุฆูุงู ูุถูุงู ุนุฏู ููุฏุงู ุจูุงูุงุช ุงูุญุถูุฑ ูู ุญุงูุฉ ุชุนุทู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ. ูุชู ุญูุธ ุงูุจูุงูุงุช ูู Google Sheets ู Google Forms ููุณุฎุฉ ุงุญุชูุงุทูุฉ ุขููุฉ.

---

## ๐ **ุงูุฎุทูุฉ 1: ุฅุนุฏุงุฏ Google Cloud Console**

### **1.1 ุฅูุดุงุก ูุดุฑูุน ุฌุฏูุฏ**
1. ุงุฐูุจ ุฅูู [Google Cloud Console](https://console.cloud.google.com)
2. ุงุถุบุท ุนูู "Select a project" โ "New Project"
3. ุงุณู ุงููุดุฑูุน: `attendance-backup-system`
4. ุงุถุบุท "Create"

### **1.2 ุชูุนูู APIs ุงููุทููุจุฉ**
1. ูู Google Cloud Consoleุ ุงุฐูุจ ุฅูู "APIs & Services" โ "Library"
2. ุงุจุญุซ ุนู ููุนูู ูุฐู APIs:
   - **Google Sheets API**
   - **Google Drive API** 
   - **Google Forms API**

### **1.3 ุฅูุดุงุก Service Account**
1. ุงุฐูุจ ุฅูู "IAM & Admin" โ "Service Accounts"
2. ุงุถุบุท "Create Service Account"
3. ุงููุฃ ุงูุชูุงุตูู:
   ```
   Service account name: attendance-backup
   Service account ID: attendance-backup
   Description: Backup service for attendance system
   ```
4. ุงุถุบุท "Create and Continue"
5. ุงุฎุชุฑ Role: **Editor**
6. ุงุถุบุท "Continue" โ "Done"

### **1.4 ุฅูุดุงุก JSON Key**
1. ูู ูุงุฆูุฉ Service Accountsุ ุงุถุบุท ุนูู ุงูุญุณุงุจ ุงูุฐู ุฃูุดุฃุชู
2. ุงุฐูุจ ุฅูู ุชุจููุจ "Keys"
3. ุงุถุบุท "Add Key" โ "Create new key"
4. ุงุฎุชุฑ ููุน "JSON"
5. ุงุถุบุท "Create"
6. **ุงุญูุธ ููู JSON** - ุณุชุญุชุงุฌู ูุงุญูุงู

---

## ๐ **ุงูุฎุทูุฉ 2: ุฅุนุฏุงุฏ Google Sheets**

### **2.1 ุฅูุดุงุก ุฌุฏูู ุงูุจูุงูุงุช**
1. ุงุฐูุจ ุฅูู [Google Sheets](https://sheets.google.com)
2. ุฃูุดุฆ ุฌุฏูู ุจูุงูุงุช ุฌุฏูุฏ
3. ุงุณู ุงูุฌุฏูู: `ูุธุงู ุญุถูุฑ ุงูุทูุงุจ - ูุณุฎุฉ ุงุญุชูุงุทูุฉ`

### **2.2 ุฅุนุฏุงุฏ ูุฑูุฉ "Attendance Records"**
ุฃูุดุฆ ูุฑูุฉ ุนูู ุจุงุณู "Attendance Records" ูุน ุงูุฃุนูุฏุฉ ุงูุชุงููุฉ:

| ุงูุนููุฏ | ุงูุนููุงู | ุงููุตู |
|--------|---------|-------|
| A | Date | ุงูุชุงุฑูุฎ |
| B | Time | ุงูููุช |
| C | Student Name | ุงุณู ุงูุทุงูุจ |
| D | Student Email | ุจุฑูุฏ ุงูุทุงูุจ |
| E | Subject | ุงููุงุฏุฉ |
| F | Session Type | ููุน ุงูุฌูุณุฉ |
| G | Status | ุงูุญุงูุฉ |
| H | QR Code | ุฑูุฒ QR |
| I | Notes | ููุงุญุธุงุช |
| J | Error Type | ููุน ุงูุฎุทุฃ |

### **2.3 ุฅุนุฏุงุฏ ูุฑูุฉ "Error Log"**
ุฃูุดุฆ ูุฑูุฉ ุนูู ุจุงุณู "Error Log" ูุน ุงูุฃุนูุฏุฉ ุงูุชุงููุฉ:

| ุงูุนููุฏ | ุงูุนููุงู | ุงููุตู |
|--------|---------|-------|
| A | Timestamp | ุงูููุช |
| B | Error Type | ููุน ุงูุฎุทุฃ |
| C | Error Message | ุฑุณุงูุฉ ุงูุฎุทุฃ |
| D | Student Data | ุจูุงูุงุช ุงูุทุงูุจ |
| E | Recovery Status | ุญุงูุฉ ุงูุงุณุชุนุงุฏุฉ |

### **2.4 ูุดุงุฑูุฉ ุงูุฌุฏูู ูุน Service Account**
1. ุงุถุบุท ุนูู "Share" ูู ุงูุฌุฏูู
2. ุฃุถู email ุงูุฎุงุต ุจู Service Account (ููุฌูุฏ ูู ููู JSON)
3. ุฃุนุทู ุตูุงุญูุฉ "Editor"
4. ุงุถุบุท "Send"

### **2.5 ุงูุญุตูู ุนูู Sheet ID**
ูู ุฑุงุจุท Google Sheetุ ุงูุณุฎ ุงูู ID:
```
https://docs.google.com/spreadsheets/d/[SHEET_ID]/edit
```

---

## ๐ **ุงูุฎุทูุฉ 3: ุฅุนุฏุงุฏ Google Form**

### **3.1 ุฅูุดุงุก ุงููููุฐุฌ**
1. ุงุฐูุจ ุฅูู [Google Forms](https://forms.google.com)
2. ุฃูุดุฆ ูููุฐุฌ ุฌุฏูุฏ
3. ุงูุนููุงู: `ูููุฐุฌ ุญุถูุฑ ุงูุทูุงุจ - ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ`

### **3.2 ุฅุถุงูุฉ ุงูุญููู ุงููุทููุจุฉ**

**ุญูู 1: ุงุณู ุงูุทุงูุจ**
- ููุน: Short answer
- ูุทููุจ: ูุนู

**ุญูู 2: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู**
- ููุน: Short answer  
- ุงูุชุญูู: Email
- ูุทููุจ: ูุนู

**ุญูู 3: ุงููุงุฏุฉ**
- ููุน: Multiple choice
- ุงูุฎูุงุฑุงุช:
  ```
  Western Rules & Solfege 1
  Western Rules & Solfege 2
  Rhythmic Movement 1
  Western Rules & Solfege 3
  Western Rules & Solfege 4
  Hymn Singing
  Rhythmic Movement 2
  Western Rules & Solfege 5
  Improvisation 1
  Western Rules & Solfege 6
  Improvisation 2
  ```

**ุญูู 4: ููุน ุงูุฌูุณุฉ**
- ููุน: Multiple choice
- ุงูุฎูุงุฑุงุช: ูุญุงุถุฑุฉุ ุนูููุ ุงูุชุญุงูุ ุฃุฎุฑู

**ุญูู 5: ุงูุชุงุฑูุฎ ูุงูููุช**
- ููุน: Date and time
- ูุทููุจ: ูุนู

**ุญูู 6: ุญุงูุฉ ุงูุญุถูุฑ**
- ููุน: Multiple choice
- ุงูุฎูุงุฑุงุช: ุญุงุถุฑุ ูุชุฃุฎุฑุ ุบุงุฆุจ

**ุญูู 7: ููุงุญุธุงุช**
- ููุน: Paragraph

### **3.3 ุงูุญุตูู ุนูู Form ID**
ูู ุฑุงุจุท Google Formุ ุงูุณุฎ ุงูู ID:
```
https://docs.google.com/forms/d/[FORM_ID]/edit
```

### **3.4 ุงูุญุตูู ุนูู Entry IDs**
1. ุงูุชุญ ุงูู Form
2. ุงุถุบุท F12 (Developer Tools)
3. ุงุฐูุจ ุฅูู ุชุจููุจ "Network"
4. ุฃุฑุณู ูููุฐุฌ ุชุฌุฑูุจู
5. ุงุจุญุซ ุนู ุงูุทูุจ ุงููุฑุณู ุฅูู `/formResponse`
6. ุงูุณุฎ ุงูู `entry.xxxxx` IDs ููู ุญูู

---

## โ๏ธ **ุงูุฎุทูุฉ 4: ุชูููู ุงููุธุงู**

### **4.1 ุฅุถุงูุฉ ูุชุบูุฑุงุช ุงูุจูุฆุฉ**
ุฃุถู ูุฐู ุงููุชุบูุฑุงุช ุฅูู ููู `.env.local`:

```env
# Google Backup Configuration
ENABLE_GOOGLE_BACKUP=true
GOOGLE_SHEETS_ID=your_sheet_id_here
GOOGLE_FORM_ID=your_form_id_here

# Google Service Account (paste the entire JSON content)
GOOGLE_SERVICE_ACCOUNT_KEY='{"type":"service_account","project_id":"your-project",...}'

# Form Entry IDs (get these from the form inspection)
GOOGLE_FORM_STUDENT_NAME_ENTRY=entry.123456789
GOOGLE_FORM_STUDENT_EMAIL_ENTRY=entry.987654321
GOOGLE_FORM_SUBJECT_ENTRY=entry.456789123
GOOGLE_FORM_SESSION_TYPE_ENTRY=entry.789123456
GOOGLE_FORM_TIMESTAMP_ENTRY=entry.321654987
GOOGLE_FORM_STATUS_ENTRY=entry.654987321
GOOGLE_FORM_NOTES_ENTRY=entry.147258369
```

### **4.2 ุชุซุจูุช ุงูููุชุจุงุช ุงููุทููุจุฉ**
```bash
npm install googleapis google-auth-library
```

### **4.3 ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู**
```bash
npm run dev
```

---

## ๐งช **ุงูุฎุทูุฉ 5: ุงุฎุชุจุงุฑ ุงููุธุงู**

### **5.1 ุงุฎุชุจุงุฑ ุงูุงุชุตุงู**
1. ุงูุชุญ ููุญุฉ ุงูุฅุฏุงุฑุฉ
2. ุงุฐูุจ ุฅูู "ุฅุฏุงุฑุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู"
3. ุชุญูู ูู ุญุงูุฉ ุงูุงุชุตุงู

### **5.2 ุงุฎุชุจุงุฑ ุงูุญูุธ ุงูุงุญุชูุงุทู**
1. ุฃููู ุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุคูุชุงู
2. ุฌุฑูุจ ุชุณุฌูู ุญุถูุฑ ุทุงูุจ
3. ุชุญูู ูู ุญูุธ ุงูุจูุงูุงุช ูู Google Sheets

### **5.3 ุงุฎุชุจุงุฑ ุงููุฒุงููุฉ**
1. ุฃุนุฏ ุชุดุบูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. ุงุถุบุท "ูุฒุงููุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู"
3. ุชุญูู ูู ููู ุงูุจูุงูุงุช ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ

---

## ๐ง **ุงุณุชูุดุงู ุงูุฃุฎุทุงุก**

### **ุฎุทุฃ: "Google Backup Service not configured"**
- ุชุญูู ูู ูุฌูุฏ ูุชุบูุฑุงุช ุงูุจูุฆุฉ
- ุชุฃูุฏ ูู ุตุญุฉ ููู Service Account JSON
- ุฃุนุฏ ุชุดุบูู ุงูุฎุงุฏู

### **ุฎุทุฃ: "Permission denied"**
- ุชุฃูุฏ ูู ูุดุงุฑูุฉ Google Sheets ูุน Service Account
- ุชุญูู ูู ุชูุนูู APIs ุงููุทููุจุฉ ูู Google Cloud

### **ุฎุทุฃ: "Form submission failed"**
- ุชุญูู ูู ุตุญุฉ Form ID
- ุชุฃูุฏ ูู ุตุญุฉ Entry IDs
- ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงููููุฐุฌ

---

## ๐ **ูุฑุงูุจุฉ ุงููุธุงู**

### **ูุคุดุฑุงุช ุงูุญุงูุฉ**
- ๐ข **ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชุตูุฉ + ุงููุณุฎ ุงูุงุญุชูุงุทู ุฌุงูุฒ**: ุงููุธุงู ูุนูู ุจูุงูู ุทุงูุชู
- ๐ก **ูุงุนุฏุฉ ุงูุจูุงูุงุช ุบูุฑ ูุชุตูุฉ + ุงููุณุฎ ุงูุงุญุชูุงุทู ุฌุงูุฒ**: ูุชู ุงูุญูุธ ูู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ
- ๐ด **ููุง ุงููุธุงููู ุบูุฑ ูุชุงุญ**: ุชุญุชุงุฌ ูุฑุงุฌุนุฉ ููุฑูุฉ

### **ุงูุชูุงุฑูุฑ ุงูุชููุงุฆูุฉ**
- ุณุฌู ูููู ุจุญุงูุฉ ุงููุธุงู
- ุชูุจููุงุช ุนูุฏ ูุดู ุงููุณุฎ ุงูุงุญุชูุงุทู
- ุชูุฑูุฑ ุฃุณุจูุนู ุจุงูุฅุญุตุงุฆูุงุช

---

## ๐ **ุงูุฎุทูุงุช ุงูุชุงููุฉ**

ุจุนุฏ ุฅุชูุงู ุงูุฅุนุฏุงุฏุ ุฃุฑุณู ูู:

1. **Google Sheets URL** ุงูุฎุงุต ุจู
2. **Google Form URL** ุงูุฎุงุต ุจู  
3. **ูุญุชููุงุช ููู JSON** ุงูุฎุงุต ุจู Service Account
4. **Entry IDs** ูู ุงููููุฐุฌ
5. **ูุงุฆูุฉ ุงูููุงุฏ ุงูุฏุฑุงุณูุฉ** ุงููุงููุฉ

ูุณุฃููู ุจุชูููู ุงููุธุงู ููุนูู ูุน ุฅุนุฏุงุฏุงุชู ุชููุงุฆูุงู! ๐